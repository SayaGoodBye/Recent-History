(()=>{"use strict";var e,t={682:(e,t,n)=>{var s=n(602),a=n(794),i=n.n(a);const r={storage:{stores:[{store:"default",props:{autoIncrement:!1,keyPath:["key"]},indexes:[{indexName:"key",keyPath:"key"}]}],version:1}};class o{constructor(e,t){this.dbName=e,this.tableName=t,this.version=i().get(r,[e,"version"],1),this._db=null}async db(){if(this._db)return this._db;const e=i().get(r,[this.dbName,"stores"],[]);return this._db=await(0,s.P2)(this.dbName,this.version,{upgrade(t){for(let{store:n,props:s,indexes:a}of e)if(!1===t.objectStoreNames.contains(n)){let e=t.createObjectStore(n,s);for(let{indexName:t,keyPath:n}of a)e.createIndex(t,n)}}}),this._db}async add(e,t){return(await this.db()).add(this.tableName,e,t)}async get(e){return(await this.db()).get(this.tableName,e)}async getFromIndex(e,t){return(await this.db()).getFromIndex(this.tableName,e,t)}async getKeyFromIndex(e,t){return(await this.db()).getKeyFromIndex(this.tableName,e,t)}async getAllKeysFromIndex(e,t,n){return(await this.db()).getAllKeysFromIndex(this.tableName,e,t,n)}async getAllFromIndex(e,t,n){return(await this.db()).getAllFromIndex(this.tableName,e,t,n)}async getAll(){return(await this.db()).getAll(this.tableName)}async set(e,t){return(await this.db()).put(this.tableName,e,t)}async setIfNotExists(e,t,n=!0){return(await this.keys()).includes(e)?null:!0===n?(await this.db()).put(this.tableName,await t(),e):(await this.db()).put(this.tableName,t(),e)}async delete(e){return(await this.db()).delete(this.tableName,e)}async deleteByIndex(e,t){await this.eachByIndex(e,t,(e=>e.delete()))}async eachByIndex(e,t,n){const s=await this.db(),a=await s.transaction(this.tableName,"readwrite");let i=await a.store.index(e).openCursor(t);const r=[];for(;i;)r.push(n(i)),i=await i.continue();await Promise.all(r),await a.done}async findFirstByIndex(e,t,n){const s=await this.db(),a=await s.transaction(this.tableName,"readwrite");let i=await a.store.index(e).openCursor(t);for(;i;){if(n(i))return await a.done,i.value;i=await i.continue()}return await a.done,null}async findByIndex(e,t,n){const s=await this.db(),a=await s.transaction(this.tableName,"readwrite");let i=await a.store.index(e).openCursor(t);const r=[];for(;i;)n&&!n(i)||r.push(i.value),i=await i.continue();return await a.done,r}async upperBound(e,t){return IDBKeyRange.upperBound(e,t)}async clear(){return(await this.db()).clear(this.tableName)}async keys(){return(await this.db()).getAllKeys(this.tableName)}async close(){(await this.db()).close(),this._db=null}async once(e,...t){const n=await e(...t);return await this.close(),n}async onceGet(e){const t=await this.get(e);return await this.close(),t}async onceSet(e,t){const n=await this.set(e,t);return await this.close(),n}async onceDelete(e){const t=await this.delete(e);return await this.close(),t}}class c{constructor(){this.index=new o("storage","default")}set(e,t){return this.index.set({key:e,data:t})}async get(e,t){const n=await this.index.getFromIndex("key",e);return i().get(n,["data"],t)}async del(e){return await this.index.deleteByIndex("key",e)}async getAll(){return(await this.index.getAll()).reduce(((e,t)=>({...e,[t.key]:t.data})),{})}}const l=async(e,t=null)=>await(new c).get(e,t),d=async e=>await(e||new c).get("closed-tabs",[]);var u=n(109);const h=e=>e?((e,t)=>{const n=u.A.stringifyUrl({url:e,query:t});return chrome.runtime.getURL(n)})("/_favicon",{pageUrl:e,size:32}):null,p=e=>{try{return new URL(e)}catch(e){return null}};class m{static BAR_ID="1";static OTHER_ID="2";static SYSTEM_FOLDER_NAME="system";static async removeSystemFolders(e){const t=(await m.getOtherTree()).find((e=>e.title===m.SYSTEM_FOLDER_NAME));if(!t)return;let n=i().get(t,["children"],[]);const s=n.find((t=>t.title===e))||null;s&&(await m.removeTree(s.id),n=n.filter((t=>t.title!==e))),0===n.length&&await m.removeTree(t.id)}static async searchSystemFolder(e){const t=(await m.getOtherTree()).find((e=>e.title===m.SYSTEM_FOLDER_NAME));return i().get(t,["children"],[]).find((t=>t.title===e))||null}static async createSystemFolder(e){let t=(await m.getOtherTree()).find((e=>e.title===m.SYSTEM_FOLDER_NAME));return t||(t=await m.create({title:m.SYSTEM_FOLDER_NAME,parentId:m.OTHER_ID})),await m.create({title:e,parentId:t.id})}static find(e,t){for(let n of e)if(n.id===t)return n;return null}static findDeep(e,t){for(let n of e){if(n.id===t)return n;if("children"in n){const e=m.findDeep(n.children,t);if(e)return e}}return null}static findDeepTop(e,t,n){const s=m.findDeep(e,t);return s?m.findDeep(s.children,n):null}static async get(e){return new Promise((t=>{chrome.bookmarks.get(e,t)}))}static async search(e){return new Promise((t=>{chrome.bookmarks.search(e,t)}))}static async getTree(){return new Promise((e=>{chrome.bookmarks.getTree((t=>{const n=i().get(t,[0,"children"])||[];e(n)}))}))}static async getBarTree(){const e=m.find(await m.getTree(),m.BAR_ID);return i().get(e,["children"],[])}static async getOtherTree(){const e=m.find(await m.getTree(),m.OTHER_ID);return i().get(e,["children"],[])}static onChanged(e){chrome.bookmarks.onChanged.addListener(e)}static onCreated(e){chrome.bookmarks.onCreated.addListener(e)}static onMoved(e){chrome.bookmarks.onMoved.addListener(e)}static onRemoved(e){chrome.bookmarks.onRemoved.addListener(e)}static async create(e){return new Promise((t=>{chrome.bookmarks.create(e,t)}))}static async update(e,t){return new Promise((n=>{chrome.bookmarks.update(e,t,n)}))}static async remove(e){return new Promise((t=>{chrome.bookmarks.remove(e,(()=>{if(chrome.runtime.lastError&&chrome.runtime.lastError.message)return t(!1);t(!0)}))}))}static async removeTree(e){return new Promise((t=>{chrome.bookmarks.removeTree(e,(()=>{if(chrome.runtime.lastError&&chrome.runtime.lastError.message)return t(!1);t(!0)}))}))}static move(e,t){return new Promise((n=>{chrome.bookmarks.move(e,t,n)}))}static getRecent(e){return new Promise((t=>{chrome.bookmarks.getRecent(e,t)}))}}const y=async e=>{e*=1;let t=await l("rh-date");const n=new Date(e);let s=n.getDate()+"",a=n.getMonth()+1+"";const i=n.getFullYear()+"";return 1===s.length&&(s="0"+s),1===a.length&&(a="0"+a),t=t.replace("dd",s),t=t.replace("mm",a),t=t.replace("yyyy",i),t};class f{static get(e){return new Promise((t=>{chrome.history.search({text:"",...e},t)}))}static add(e){return new Promise((t=>{chrome.history.addUrl({url:e},t)}))}static getVisits(e){return new Promise((t=>{chrome.history.getVisits({url:e},t)}))}static remove(e){return new Promise((t=>{chrome.history.deleteUrl({url:e},(()=>{setTimeout(t,50)}))}))}static removeRange(e,t){return new Promise((n=>{chrome.history.deleteRange({startTime:e,endTime:t},(()=>{setTimeout(n,50)}))}))}static onVisited(e){chrome.history.onVisited.addListener(e)}static onVisitRemoved(e){chrome.history.onVisitRemoved.addListener(e)}}const w=(e,t)=>chrome.i18n.getMessage(e,t),g=(e,t)=>{let n="";const s=0===e?new Date:new Date(e);let a=s.getHours(),i=s.getMinutes();return"12"===t&&(n=a>11?" "+w("PM"):" "+w("AM"),0===a&&(a=12),a>12&&(a-=12)),a<10&&(a="0"+a),i<10&&(i="0"+i),a+":"+i+n},b={ctrlState:"false",shiftState:"false",itemSelectedColor:"#ffcbd3",selectedItem:void 0,prh:void 0},v=e=>b[e],k=(e,t)=>{b[e]=t};class x{static async getTabs(e={}){return new Promise((t=>{chrome.tabs.query(e,t)}))}static async getActive(e=!0){return new Promise((t=>{chrome.tabs.query({active:!0,currentWindow:e},(e=>{t(e.length?e[0]:null)}))}))}static openNewTab(e,t={},n){const s={url:e,...t};chrome.tabs.create(s,n)}static update(e,t={},n){chrome.tabs.update(e,t,n)}}var T=n(692),N=n.n(T);async function O(e){const t=document.createElement("a"),n=await l("rhs-showurl"),s=await l("rhs-showext"),a=(e=>e.replace(/<script[^>]*>.*?<\/script>/gi,""))(e.title).replace(/"/g,"&#34;").replace(/</g,"").replace(/>/g,"").replace(/\//g,"");const i="yes"===n||"yes"===s?'style="margin-left: 2px;"':"",r="no"===n?'style="display:none;"':"";let o;o="no"===s?'style="display:none;"':"rh"===e.type||"mv"===e.type?"":'style="display:none;"',"yes"===await l("rhs-showsep")&&(t.style.borderBottom="1px solid #ccc");const c="yes"===s&&"yes"===n?" | ":"";let d=a===e.url?a:a+" | "+e.url;void 0!==e.time&&(d=d+" | "+e.time);const u="pi"===e.type?`<span class="ui-delete" data-function="${e.type}">&nbsp;</span>`:`<span class="ui-pin" data-function="${e.type}">&nbsp;</span><span class="ui-delete" data-function="${e.type}">&nbsp;</span>`;return t.addEventListener("click",(async t=>{t.stopPropagation(),t.preventDefault();const n=await l("rh-click");if("true"===v("ctrlState")||1===t.button)x.openNewTab(e.url,{selected:!1});else if("current"===n){const t=await x.getActive();x.update(t.id,{url:e.url},(()=>{window.close()}))}else"newtab"===n?x.openNewTab(e.url,{selected:!0},(()=>{window.close()})):"newbgtab"===n&&x.openNewTab(e.url,{selected:!1})})),t.addEventListener("contextmenu",(()=>{!function(e){if(null===e)return;const t=document.createElement("textarea");t.style.position="absolute",t.style.left="-100%",t.value=e,document.body.appendChild(t),t.select(),document.execCommand("Copy"),document.body.removeChild(t)}(e.url)})),t.classList.add("item"),t.setAttribute("href",e.url),t.setAttribute("target","_blank"),t.innerHTML=`\n    <img class="favicon" alt="Favicon" src="${e.favicon}">\n    <span class="title" title="${d}">\n      <span class="edit-items-ui" data-url="${e.url}" data-title="${d.replace(/'/g,"\\'")}">${u}</span>\n      ${a}\n    </span>\n    <span ${i} class="extra-url">\n      <span ${o} class="extra">${w("visits")}: ${e.visits||""}${c}</span>\n      <span ${r} class="url">${e.url.replace(/^(.*?):\/\//,"").replace(/\/$/,"")}</span>\n    </span>\n  `,t}async function E(e){const t=JSON.parse(await l("rh-pinned"));N()(e).each((function(){const n=N()(this);if(t.length>0)for(let s in t)void 0!==t[s]&&t[s].url===n.attr("href")&&("#rh-views .item .link"===e?n.closest("div.item").find("span.pin")&&n.closest("div.item").find("span.pin").css("background-image",'url("images/pin.png")'):"#f0fff1"!==n.css("background-color")&&n.css("background-color","#f0fff1"))}))}window.addEventListener("DOMContentLoaded",(async()=>{var e,t;"true"!==await l("rh-version-26.1.31")&&(e=w("successfullyInstalled")+"<span>v26.1.31</span>","close"===(t="open")?(N()("#alert-holder").css("display","none"),N()("#alert-yes").destroy(),N()("#alert-no").destroy()):"open"===t&&(N()("#alert-holder").css("display","block"),N()("#alert-text").html(e),setTimeout((()=>{N()("#alert-holder").css("display","none")}),3e3)),await(async(e,t)=>await(new c).set(e,t))("rh-version-26.1.31","true")),N()(document.body).on("keydown",(e=>{17===e.keyCode&&"false"===v("ctrlState")&&k("ctrlState","true")})),N()(document.body).on("keyup",(e=>{17===e.keyCode&&k("ctrlState","false")}));const n=(await l("rh-list-order")).split(","),s=document.getElementById("popup-insert");for(let e in n){const t=document.createElement("div");if("rh-order"===n[e])1*await l("rh-itemsno")>0&&(t.id="rh-inject",t.innerHTML=`\n          <div id="rh-inject-title" class="popup-title">\n            <span>${w("recentHistory")}</span>\n          </div>\n        `,s.appendChild(t));else if("rct-order"===n[e]){if(1*await l("rct-itemsno")>0){(await d()).length>0&&(t.id="rct-inject",t.innerHTML=`\n            <div id="rct-inject-title" class="popup-title">\n                <span>${w("recentlyClosedTabs")}</span>\n            </div>\n          `,s.appendChild(t))}}else"rb-order"===n[e]?1*await l("rb-itemsno")>0&&(t.id="rb-inject",t.innerHTML=`\n          <div id="rb-inject-title" class="popup-title">\n              <span>${w("recentBookmarks")}</span>\n          </div>\n        `,s.appendChild(t)):"mv-order"===n[e]&&1*await l("mv-itemsno")>0&&(t.id="mv-inject",t.innerHTML=`\n          <div id="mv-inject-title" class="popup-title">\n              <span>${w("mostVisited")}</span>\n          </div>\n        `,s.appendChild(t))}N()("#show-all-history").on("click",(()=>{x.openNewTab("chrome://history/",{selected:!0})}));const a=N()("#rh-inject");if(a){const e=await(async()=>{const e=[];let t=0,n=1*await l("rh-itemsno");const s=n,a=await l("rh-filtered");if(n*=4,n>0){const i={maxResults:n,endTime:(new Date).getTime(),startTime:(new Date).getTime()-24192e5},r=await f.get(i),o=await l("rh-timeformat");for(let n=0;n<=r.length&&t!==s;n++){if(void 0===r[n])continue;let s=r[n].title;const i=r[n].url,c=/^(file|chrome|chrome-extension|chrome-devtools):\/\//.test(i);if(""===s&&(s=i),"false"===a)c||(e.push({type:"rh",title:s,url:i,visits:r[n].visitCount,favicon:h(r[n].url),time:g(r[n].lastVisitTime,o)}),t++);else{const l=p(i);l&&-1===a.indexOf(l.host+"|")&&(c||(e.push({type:"rh",title:s,url:i,visits:r[n].visitCount,favicon:h(r[n].url),time:g(r[n].lastVisitTime,o)}),t++))}}}return e})();for(let t of e){const e=await O(t);a.append(e)}0===e.length&&a.css("display","none"),"yes"===await l("rhs-showbg")&&await E("#rh-inject .item")}const i=N()("#rct-inject");if(i){const e=await(async()=>{const e=[],t=1*await l("rct-itemsno"),n=await l("rh-filtered");let s=0;if(t>0){const a=await d();if(0===a.length)return e;for(let i=0;i<99&&t!==s&&void 0!==a[i];i++){let t=a[i].title;const r=a[i].url,o=a[i].time,c=h(r);if((""===t&&(t=r),void 0!==t)&&!/^(file|chrome|chrome-extension|chrome-devtools):\/\//.test(r))if(void 0===a[i-1]){const a=p(r);a&&-1===n.indexOf(a.host+"|")&&(e.push({type:"rct",title:t,url:r,favicon:c,time:o}),s++)}else if(a[i-1].url!==r){const a=p(r);a&&-1===n.indexOf(a.host+"|")&&(e.push({type:"rct",title:t,url:r,favicon:c,time:o}),s++)}}}return e})();for(let t of e){const e=await O(t);i.append(e)}0===e.length&&i.css("display","none"),"yes"===await l("rhs-showbg")&&await E("#rct-inject .item")}const r=N()("#rb-inject");if(r){const e=await(async()=>{const e=[],t=1*await l("rb-itemsno");if(t>0){const n=await m.getRecent(t);if(0===n.length)return e;for(let t=0;t<=n.length;t++){if(void 0===n[t])continue;let s=n[t].title;const a=n[t].url,i=h(a);""===s&&(s=a),e.push({type:"rb",url:a,title:s,favicon:i,time:await y(n[t].dateAdded)})}}return e})();for(let t of e){const e=await O(t);r.append(e)}0===e.length&&r.css("display","none")}const o=N()("#mv-inject");if(o){const e=await(async()=>{const e=[],t=await l("mv-cache",[]),n=1*await l("mv-itemsno"),s=await l("mv-blocklist");let a=0;for(let i=0;i<45&&a!==n;i++)void 0!==t[i].title&&-1===s.indexOf(t[i].url+"|")&&(e.push({type:"mv",url:t[i].url,favicon:h(t[i].url),title:t[i].title,visits:t[i].visitCount}),a++);return e})();for(let t of e){const e=await O(t);o.append(e)}0===e.length&&o.css("display","none")}N()(".favicon").on("error",(function(){this.attr("src","images/blank.png")}));const u=N()(".popup-title");if(u.each((function(e,t){0!==t&&N()(e).css("margin-top","6px")})),"yes"===await l("rh-search")){const e=N()("#popup-insert"),t=N()("#popup-search-input"),n=N()("#popup-search-insert");t.on("keyup",(async function(){const t=N()(this).val();if(t.length>2){const s=await(async e=>{if(""===e&&void 0===e)return[];const t=[],n=await f.get({text:e,maxResults:30});for(let e=0;e<=n.length;e++)if(void 0!==n[e]){let s=n[e].title;const a=n[e].url;if(""===s)continue;t.push({type:"rh",title:s,url:a,favicon:h(a),visits:n[e].visitCount})}return t})(t);n.text("");for(let e of s){const t=await O(e);n.append(t)}0===s.length?n.html(`<div class="no-results"><span>${w("noResults")}</span></div>`):"yes"===await l("rhs-showbg")&&await E("#popup-search-insert "),e.css("display","none"),n.css("display","block")}else e.css("display","block"),n.css("display","none")})),N()("#popup-search-clear").on("click",(function(){t.val(""),t.focus(),e.css("display","block"),n.css("display","none"),n.text("")})),t.focus()}else N()("#popup-header").css("display","none"),u.length>0&&u[0].css("margin-top","10px");N()("#alert-holder").on("click",(function(){this.css("display","none")}));N()(document.body).css("width",await l("rh-width")),N()(".lang").each((function(){this.innerHTML=w(N()(this).attr("data-lang-string"))}))}))}},n={};function s(e){var a=n[e];if(void 0!==a)return a.exports;var i=n[e]={exports:{}};return t[e].call(i.exports,i,i.exports,s),i.exports}s.m=t,e=[],s.O=(t,n,a,i)=>{if(!n){var r=1/0;for(d=0;d<e.length;d++){for(var[n,a,i]=e[d],o=!0,c=0;c<n.length;c++)(!1&i||r>=i)&&Object.keys(s.O).every((e=>s.O[e](n[c])))?n.splice(c--,1):(o=!1,i<r&&(r=i));if(o){e.splice(d--,1);var l=a();void 0!==l&&(t=l)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[n,a,i]},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.j=887,(()=>{var e={887:0};s.O.j=t=>0===e[t];var t=(t,n)=>{var a,i,[r,o,c]=n,l=0;if(r.some((t=>0!==e[t]))){for(a in o)s.o(o,a)&&(s.m[a]=o[a]);if(c)var d=c(s)}for(t&&t(n);l<r.length;l++)i=r[l],s.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return s.O(d)},n=self.webpackChunkrecenthistory=self.webpackChunkrecenthistory||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var a=s.O(void 0,[96],(()=>s(682)));a=s.O(a)})();